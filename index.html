<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>FinTrack</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=DM+Sans:wght@400;500;600&display=swap"
    rel="stylesheet">


  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    body {
    font-family: 'DM Sans', sans-serif;
    background: linear-gradient(135deg, #0f172a, #1e293b);
    color: #e2e8f0;
    margin: 0;
}

.chart-container {
    display: flex;
    gap: 2rem;
    flex-wrap: wrap;
    margin-top: 2rem;
}

.chart-box {
    flex: 1;
    min-width: 300px;
    background: rgba(30, 41, 59, 0.5);
    padding: 1rem;
    border-radius: 1rem;
}

.navbar {
    display: flex;
    justify-content: space-between;
    padding: 1rem 2rem;
    background: rgba(15, 23, 42, 0.85);
    position: sticky;
    top: 0;
}

/* Add Button */
.add-btn {
    background: linear-gradient(135deg, #10b981, #059669);
    border: none;
    padding: 0.7rem 1.5rem;
    border-radius: 2px;
    font-weight: 600;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 1rem;
}

.add-btn:hover {
    transform: translateY(-3px);
}

.add-btn:active {
    transform: scale(0.95);
}

.logo {
    font-family: 'Playfair Display', serif;
    font-size: 1.7rem;
    background: linear-gradient(135deg, #10b981, #059669);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
}

.nav-links a {
    margin-right: 1rem;
    cursor: pointer;
    color: #cbd5e1;
}

.nav-links a.active {
    color: #10b981;
}

.main-content {
    padding: 2rem;
    max-width: 1300px;
    margin: auto;
}

.summary-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.summary-card {
    background: rgba(30, 41, 59, 0.6);
    backdrop-filter: blur(12px);
    padding: 1.5rem;
    border-radius: 1rem;
    transition: all 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.summary-card:hover {
    transform: translateY(-5px);
}


.summary-card h3 {
    margin: 0;
    font-size: 0.9rem;
    color: #94a3b8;
}

.amount {
    font-size: 2.2rem;
    font-family: 'Playfair Display', serif;
    margin-top: 0.5rem;
}

canvas {
    max-width: 100%;
}

.summary-card:nth-child(1) {
    border-left: 4px solid #10b981;
}

.summary-card:nth-child(2) {
    border-left: 4px solid #ef4444;
}

.summary-card:nth-child(3) {
    border-left: 4px solid #3b82f6;
}

/* Transaction Box Container */
.transaction-box {
    max-width: 700px;
    margin: 3rem auto;
    padding: 2rem;
    background: rgba(30, 41, 59, 0.6);
    backdrop-filter: blur(12px);
    border-radius: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.05);
    text-align: center;
}

/* Horizontal Form Layout */
.transaction-form {
    display: flex;
    gap: 1rem;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    margin-top: 1.5rem;
}

/* Input & Select Styling */
.transaction-form input,
.transaction-form select {
    padding: 0.8rem 1rem;
    border-radius: 0.8rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(15, 23, 42, 0.8);
    color: #e2e8f0;
    font-size: 1rem;
    outline: none;
    transition: 0.3s ease;
    min-width: 180px;
}

/* Focus Effect */
.transaction-form input:focus,
.transaction-form select:focus {
    border-color: #10b981;
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
}
  </style>
</head>

<body>

  <!-- NAVBAR -->
  <nav class="navbar">
    <div class="logo">FinTrack</div>
    <div class="nav-links">
      <a class="active" onclick="showPage('dashboard')">Dashboard</a>
      <a onclick="showPage('transactions')">Transactions</a>
      <a onclick="showPage('profile')">Profile</a>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="main-content">

    <!-- DASHBOARD -->
    <section id="dashboard">
      <h1>Welcome back, GT EditsðŸ‘‹</h1>

      <div class="summary-cards">
        <div class="summary-card">
          <h3>Total Income</h3>
          <div class="amount" id="income">â‚¹0</div>
        </div>

        <div class="summary-card">
          <h3>Total Expenses</h3>
          <div class="amount" id="expenses">â‚¹0</div>
        </div>

        <div class="summary-card">
          <h3>Balance</h3>
          <div class="amount" id="balance">â‚¹0</div>
        </div>
      </div>


      <div class="chart-container">
        <div class="chart-box">
          <canvas id="pieChart"></canvas>
        </div>
        <div class="chart-box">
          <canvas id="barChart"></canvas>
        </div>
      </div>

    </section>

    <!-- TRANSACTIONS -->
    <section id="transactions" style="display:none">
      <div class="transaction-box">
        <h2>Add Transaction</h2>

        <div class="transaction-form">
          <input id="amount" type="number" placeholder="Enter Amount">

          <select id="type">
            <option value="income">Income</option>
            <option value="expense">Expense</option>
          </select>

          <button class="add-btn" onclick="addTransaction()">
            + Add
          </button>
        </div>
      </div>



      <ul id="txList"></ul>
    </section>

    <!-- PROFILE -->
    <section id="profile" style="display:none">
      <h2>Profile</h2>
      <p>Name: Tanishq Mehta</p>
      <p>Email: tm@gmail.com</p>
    </section>

  </main>

  <script>
    lucide.createIcons();

    const API_URL = "/transactions";
    let transactions = [];

    /* ---------- PAGE SWITCH ---------- */
    function showPage(page) {
      document.querySelectorAll("section").forEach(s => s.style.display = "none");
      document.getElementById(page).style.display = "block";

      document.querySelectorAll(".nav-links a").forEach(a => a.classList.remove("active"));
      event.target.classList.add("active");
    }

    /* ---------- API INTERACTIONS ---------- */
    async function fetchTransactions() {
      try {
        const res = await fetch(API_URL);
        if (!res.ok) throw new Error("Failed to fetch");
        transactions = await res.json();
        calculate();
      } catch (err) {
        console.error("Error loading transactions:", err);
        // Fallback for demo if backend isn't running
        // transactions = []; 
        // calculate();
      }
    }

    async function addTransaction() {
      const amountVal = document.getElementById("amount").value;
      const type = document.getElementById("type").value;

      if (!amountVal) return;
      const amount = Number(amountVal);

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ amount, type })
        });

        if (res.ok) {
          // Clear input
          document.getElementById("amount").value = "";
          // Refresh data
          fetchTransactions();
        } else {
          alert("Failed to save transaction");
        }
      } catch (err) {
        console.error("Error adding transaction:", err);
        alert("Backend error");
      }
    }

    /* ---------- CALCULATIONS ---------- */
    function calculate() {
      let income = 0, expense = 0;

      transactions.forEach(t => {
        // Ensure amount is a number
        const amt = Number(t.amount);
        if (t.type === "income") income += amt;
        else expense += amt;
      });

      document.getElementById("income").innerText = "â‚¹" + income;
      document.getElementById("expenses").innerText = "â‚¹" + expense;
      document.getElementById("balance").innerText = "â‚¹" + (income - expense);

      renderCharts(income, expense);
      renderTransactions();
    }

    /* ---------- CHARTS ---------- */
    let pieChart, barChart;

    function renderCharts(income, expense) {
      if (pieChart) pieChart.destroy();
      if (barChart) barChart.destroy();

      pieChart = new Chart(document.getElementById("pieChart"), {
        type: "pie",
        data: {
          labels: ["Income", "Expense"],
          datasets: [{
            data: [income, expense],
            backgroundColor: ["#10b981", "#ef4444"]
          }]
        }
      });

      barChart = new Chart(document.getElementById("barChart"), {
        type: "bar",
        data: {
          labels: ["Income", "Expense"],
          datasets: [{
            data: [income, expense],
            backgroundColor: ["#10b981", "#ef4444"]
          }]
        }
      });
    }

    /* ---------- TRANSACTIONS RENDER ---------- */
    function renderTransactions() {
      const list = document.getElementById("txList");
      list.innerHTML = "";
      transactions.forEach(t => {
        const li = document.createElement("li");
        li.style.background = "rgba(30, 41, 59, 0.6)";
        li.style.padding = "0.8rem 1rem";
        li.style.marginBottom = "0.7rem";
        li.style.borderRadius = "0.8rem";
        li.style.display = "flex";
        li.style.justifyContent = "space-between";
        li.style.alignItems = "center";
        li.style.boxShadow = "0 6px 15px rgba(0,0,0,0.3)";


        const typeSpan = document.createElement("span");
        typeSpan.innerText = t.type.toUpperCase();
        typeSpan.style.color = t.type === "income" ? "#10b981" : "#ef4444";
        typeSpan.style.fontWeight = "bold";

        const amtSpan = document.createElement("span");
        amtSpan.innerText = `â‚¹${t.amount}`;

        li.appendChild(typeSpan);
        li.appendChild(amtSpan);
        list.appendChild(li);
      });
    }

    // Initial Fetch
    fetchTransactions();
  </script>

</body>

</html>